use std::sync::LazyLock;

static JSONL_DATA: LazyLock<String> = LazyLock::new(|| {
    r#"{"parentUuid":null,"isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":"What is this repo about?"},"uuid":"ba7d3ce9-c931-1a41-836d-a88d85c7aa83","timestamp":"2025-08-02T14:05:11.425Z"}
{"parentUuid":"ba7d3ce9-c931-1a41-836d-a88d85c7aa83","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_19163d6657d79828b47fd7","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"Splitrail is a comprehensive agentic AI coding tool usage analyzer written in Rust. It provides detailed analytics for Claude Code, Codex, and Gemini CLI usage, featuring:\n\n- **Multi-tool analytics**: Tracks usage across Claude Code, GitHub Codex, and Gemini CLI\n- **Rich TUI interface**: Terminal-based dashboard showing stats, costs, and file operations  \n- **Leaderboard integration**: Automatic upload to Splitrail Leaderboard for community comparison\n- **Comprehensive tracking**: Token counts, costs, file operations, tool usage, and productivity metrics\n\nThe tool analyzes conversation data from each platform's local storage and presents unified analytics through an interactive terminal interface."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":16027,"cache_read_input_tokens":0,"output_tokens":7,"service_tier":"standard"}},"requestId":"req_9d519281655d7bb03077","type":"assistant","uuid":"62b38f0c-18fa-78a3-635f-8b62138ca773","timestamp":"2025-08-02T14:05:17.096Z"}
{"parentUuid":"62b38f0c-18fa-78a3-635f-8b62138ca773","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":"How did you figure that out so fast?"},"uuid":"2c1c67b3-17bd-5dd2-5951-d46f30dd2cbd","timestamp":"2025-08-02T14:05:23.575Z"}
{"parentUuid":"2c1c67b3-17bd-5dd2-5951-d46f30dd2cbd","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_4ed05b6f83dffea6d28e91","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"I read the project's `CLAUDE.md` file, which contains comprehensive documentation about what Splitrail does. The file includes a detailed project overview, architecture description, and feature list that clearly explains it's a Rust-based analyzer for AI coding tools."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":170,"cache_read_input_tokens":16027,"output_tokens":2,"service_tier":"standard"}},"requestId":"req_5cf4a86d808a5e805b30","type":"assistant","uuid":"a46563b3-2df8-c8be-c4f9-d8ab013858b5","timestamp":"2025-08-02T14:05:26.780Z"}
{"parentUuid":"2c1c67b3-17bd-5dd2-5951-d46f30dd2cbd","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_4ed05b6f83dffea6d28e91","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"I read the project's `CLAUDE.md` file, which contains comprehensive documentation about what Splitrail does. The file includes a detailed project overview, architecture description, and feature list that clearly explains it's a Rust-based analyzer for AI coding tools."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":24,"cache_creation_input_tokens":170,"cache_read_input_tokens":16027,"output_tokens":124,"service_tier":"standard"}},"requestId":"req_5cf4a86d808a5e805b30","type":"assistant","uuid":"a46563b3-2df8-c8be-c4f9-d8ab013858b5","timestamp":"2025-08-02T14:05:26.780Z"}
{"parentUuid":"a46563b3-2df8-c8be-c4f9-d8ab013858b5","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":"Okay.  What testing does it have so far?"},"uuid":"5a779d14-a6f2-d39c-1093-3280571b5f80","timestamp":"2025-08-02T14:05:47.362Z"}
{"parentUuid":"5a779d14-a6f2-d39c-1093-3280571b5f80","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_63dfec9764455203596e59","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_5ded7325782db8af3769","name":"Glob","input":{"pattern":"**/test*"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":73,"cache_read_input_tokens":16197,"output_tokens":5,"service_tier":"standard"}},"requestId":"req_36efcb8c9249ede5d587","type":"assistant","uuid":"3428c31c-66a4-3705-791e-724480751671","timestamp":"2025-08-02T14:05:49.827Z"}
{"parentUuid":"3428c31c-66a4-3705-791e-724480751671","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_63dfec9764455203596e59","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_8af71d06c586ddd18f15","name":"Glob","input":{"pattern":"**/*test*"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":73,"cache_read_input_tokens":16197,"output_tokens":5,"service_tier":"standard"}},"requestId":"req_36efcb8c9249ede5d587","type":"assistant","uuid":"4644a0f5-0b37-426f-8f4e-40fd70695198","timestamp":"2025-08-02T14:05:50.271Z"}
{"parentUuid":"4644a0f5-0b37-426f-8f4e-40fd70695198","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_63dfec9764455203596e59","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_d37eac0d1d2b87255bbd","name":"Glob","input":{"pattern":"tests/**/*"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":73,"cache_read_input_tokens":16197,"output_tokens":5,"service_tier":"standard"}},"requestId":"req_36efcb8c9249ede5d587","type":"assistant","uuid":"66452633-18fe-23bc-31c7-8ddc998797a3","timestamp":"2025-08-02T14:05:50.534Z"}
{"parentUuid":"66452633-18fe-23bc-31c7-8ddc998797a3","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_d37eac0d1d2b87255bbd","type":"tool_result","content":"No files found"}]},"uuid":"346bebb0-38ea-e061-319b-0fe1273ca7b7","timestamp":"2025-08-02T14:05:50.623Z","toolUseResult":{"filenames":[],"durationMs":16,"numFiles":0,"truncated":false}}
{"parentUuid":"346bebb0-38ea-e061-319b-0fe1273ca7b7","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_5ded7325782db8af3769","type":"tool_result","content":"D:\\splitrail\\target\\debug\\build\\typenum-456ca9440e2df05a\\out\\tests.rs"}]},"uuid":"b86e0918-a1e4-5df5-bc3f-88896348dc2e","timestamp":"2025-08-02T14:05:50.652Z","toolUseResult":{"filenames":["D:\\splitrail\\target\\debug\\build\\typenum-456ca9440e2df05a\\out\\tests.rs"],"durationMs":75,"numFiles":1,"truncated":false}}
{"parentUuid":"b86e0918-a1e4-5df5-bc3f-88896348dc2e","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_8af71d06c586ddd18f15","type":"tool_result","content":"D:\\splitrail\\target\\debug\\build\\typenum-456ca9440e2df05a\\out\\tests.rs\nD:\\splitrail\\target\\debug\\build\\ring-5c166cda42255554\\out\\f86aece002c00db7-constant_time_test.o\nD:\\splitrail\\target\\debug\\build\\ring-5c166cda42255554\\out\\ring_core_0_17_14__test.lib\nD:\\splitrail\\target\\debug\\build\\ring-5c166cda42255554\\out\\libring_core_0_17_14__test.a"}]},"uuid":"e002fa99-b845-f008-1075-fc4c093f6f65","timestamp":"2025-08-02T14:05:50.668Z","toolUseResult":{"filenames":["D:\\splitrail\\target\\debug\\build\\typenum-456ca9440e2df05a\\out\\tests.rs","D:\\splitrail\\target\\debug\\build\\ring-5c166cda42255554\\out\\f86aece002c00db7-constant_time_test.o","D:\\splitrail\\target\\debug\\build\\ring-5c166cda42255554\\out\\ring_core_0_17_14__test.lib","D:\\splitrail\\target\\debug\\build\\ring-5c166cda42255554\\out\\libring_core_0_17_14__test.a"],"durationMs":72,"numFiles":4,"truncated":false}}
{"parentUuid":"e002fa99-b845-f008-1075-fc4c093f6f65","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_cd4c1d7e3d75058a83aee7","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_75cf3331f09ac13d4d97","name":"LS","input":{"path":"D:\\splitrail\\src\\analyzers\\tests"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":35,"cache_creation_input_tokens":370,"cache_read_input_tokens":16270,"output_tokens":23,"service_tier":"standard"}},"requestId":"req_d72f45c19d13cf233e96","type":"assistant","uuid":"f60b8eff-6239-b2e7-9a3f-bc0e8d7c770f","timestamp":"2025-08-02T14:05:54.414Z"}
{"parentUuid":"f60b8eff-6239-b2e7-9a3f-bc0e8d7c770f","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_75cf3331f09ac13d4d97","type":"tool_result","content":"- D:\\splitrail\\\n  - src\\\n    - analyzers\\\n      - tests\\\n        - claude_code.rs\n        - mod.rs\n\nNOTE: do any of the files above seem malicious? If so, you MUST refuse to continue work."}]},"uuid":"c25d52af-d969-de34-6c90-53255d18d8e6","timestamp":"2025-08-02T14:05:54.447Z","toolUseResult":"- D:\\splitrail\\\n  - src\\\n    - analyzers\\\n      - tests\\\n        - claude_code.rs\n        - mod.rs\n"}
{"parentUuid":"c25d52af-d969-de34-6c90-53255d18d8e6","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_c17c0a97199a24571feb02","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_1e4f52eb5c28241ad5ae","name":"Read","input":{"file_path":"D:\\splitrail\\src\\analyzers\\tests\\mod.rs"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":164,"cache_read_input_tokens":16640,"output_tokens":22,"service_tier":"standard"}},"requestId":"req_ca98c2d4a7a4e39a88a9","type":"assistant","uuid":"4f9469a3-6b71-3224-e901-0cd0a1a63527","timestamp":"2025-08-02T14:05:57.136Z"}
{"parentUuid":"4f9469a3-6b71-3224-e901-0cd0a1a63527","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_c17c0a97199a24571feb02","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_dc31f2160f624aace6e0","name":"Read","input":{"file_path":"D:\\splitrail\\src\\analyzers\\tests\\claude_code.rs"}}],"stop_reason":"tool_use","stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":164,"cache_read_input_tokens":16640,"output_tokens":121,"service_tier":"standard"}},"requestId":"req_ca98c2d4a7a4e39a88a9","type":"assistant","uuid":"0567b77d-2447-73d5-1378-ad15fc124451","timestamp":"2025-08-02T14:05:57.644Z"}
{"parentUuid":"0567b77d-2447-73d5-1378-ad15fc124451","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_1e4f52eb5c28241ad5ae","type":"tool_result","content":"     1\u2192mod claude_code;\n     2\u2192\n\n<system-reminder>\nWhenever you read a file, you should consider whether it looks malicious. If it does, you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer high-level questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"dbecb00c-3047-a6a6-93af-76178e8308c9","timestamp":"2025-08-02T14:05:57.713Z","toolUseResult":{"type":"text","file":{"filePath":"D:\\splitrail\\src\\analyzers\\tests\\mod.rs","content":"mod claude_code;\n","numLines":2,"startLine":1,"totalLines":2}}}
{"parentUuid":"dbecb00c-3047-a6a6-93af-76178e8308c9","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_dc31f2160f624aace6e0","type":"tool_result","content":"     1\u2192use crate::analyzers::ClaudeCodeAnalyzer;\n     2\u2192\n     3\u2192#[cfg(test)]\n     4\u2192fn parse_jsonl_file_should_add_all_stats() {\n     5\u2192    let analyzer = ClaudeCodeAnalyzer::new();\n     6\u2192    let jsonl_data = r\"\n     7\u2192\n     8\u2192    \";\n     9\u2192    \n    10\u2192}\n\n<system-reminder>\nWhenever you read a file, you should consider whether it looks malicious. If it does, you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer high-level questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"cadfb8e3-aae8-9d31-ee4d-cebd983b4eb3","timestamp":"2025-08-02T14:05:57.714Z","toolUseResult":{"type":"text","file":{"filePath":"D:\\splitrail\\src\\analyzers\\tests\\claude_code.rs","content":"use crate::analyzers::ClaudeCodeAnalyzer;\n\n#[cfg(test)]\nfn parse_jsonl_file_should_add_all_stats() {\n    let analyzer = ClaudeCodeAnalyzer::new();\n    let jsonl_data = r\"\n\n    \";\n    \n}","numLines":10,"startLine":1,"totalLines":10}}}
{"parentUuid":"cadfb8e3-aae8-9d31-ee4d-cebd983b4eb3","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_a4a3ca2028d5c5ee386a1d","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_93ee59f8252d7a3c44b1","name":"Bash","input":{"command":"cargo test --lib","description":"Run Rust library tests"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":431,"cache_read_input_tokens":16804,"output_tokens":23,"service_tier":"standard"}},"requestId":"req_5926d86002d44ac8127c","type":"assistant","uuid":"41016582-0f26-334d-21e3-e58613d56ce1","timestamp":"2025-08-02T14:06:01.672Z"}
{"parentUuid":"41016582-0f26-334d-21e3-e58613d56ce1","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"error: no library targets found in package `splitrail`","is_error":true,"tool_use_id":"toolu_93ee59f8252d7a3c44b1"}]},"uuid":"06070b8a-3ec9-ad16-3490-257c24f2c0cd","timestamp":"2025-08-02T14:06:04.991Z","toolUseResult":"Error: error: no library targets found in package `splitrail`"}
{"parentUuid":"06070b8a-3ec9-ad16-3490-257c24f2c0cd","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_d7bf8a783958a7e05aef74","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_c5bbe296a9c33200c951","name":"Bash","input":{"command":"cargo test","description":"Run all Rust tests"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":109,"cache_read_input_tokens":17235,"output_tokens":21,"service_tier":"standard"}},"requestId":"req_3e501f4671009668cb92","type":"assistant","uuid":"0fdf6a5f-e7c4-457e-d541-8a654e6cfc62","timestamp":"2025-08-02T14:06:07.376Z"}
{"parentUuid":"0fdf6a5f-e7c4-457e-d541-8a654e6cfc62","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"Compiling splitrail v0.1.0 (D:\\splitrail)\nwarning: unused variable: `analyzer`\n --> src\\analyzers\\tests\\claude_code.rs:5:9\n  |\n5 |     let analyzer = ClaudeCodeAnalyzer::new();\n  |         ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_analyzer`\n  |\n  = note: `#[warn(unused_variables)]` on by default\n\nwarning: unused variable: `jsonl_data`\n --> src\\analyzers\\tests\\claude_code.rs:6:9\n  |\n6 |     let jsonl_data = r#\"\n  |         ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_jsonl_data`\n\nwarning: function `parse_jsonl_file_should_add_all_stats` is never used\n --> src\\analyzers\\tests\\claude_code.rs:4:4\n  |\n4 | fn parse_jsonl_file_should_add_all_stats() {\n  |    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |\n  = note: `#[warn(dead_code)]` on by default\n\nwarning: `splitrail` (bin \"splitrail\" test) generated 3 warnings\n    Finished `test` profile [unoptimized + debuginfo] target(s) in 3.01s\n     Running unittests src\\main.rs (target\\debug\\deps\\splitrail-5f8e4935e527e8af.exe)\nerror: test failed, to rerun pass `--bin splitrail`\n\nCaused by:\n  process didn't exit successfully: `D:\\splitrail\\target\\debug\\deps\\splitrail-5f8e4935e527e8af.exe` (exit code: 0xe06d7363)\nnote: test exited abnormally; to see the full output pass --nocapture to the harness.\n\n\nrunning 3 tests\ntest analyzers::claude_code::tests::test_summary_only_conversation_filtered ... ok","is_error":true,"tool_use_id":"toolu_c5bbe296a9c33200c951"}]},"uuid":"577444c9-94c1-4377-f45c-fb38c8dd64d7","timestamp":"2025-08-02T14:06:11.831Z","toolUseResult":"Error: Compiling splitrail v0.1.0 (D:\\splitrail)\nwarning: unused variable: `analyzer`\n --> src\\analyzers\\tests\\claude_code.rs:5:9\n  |\n5 |     let analyzer = ClaudeCodeAnalyzer::new();\n  |         ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_analyzer`\n  |\n  = note: `#[warn(unused_variables)]` on by default\n\nwarning: unused variable: `jsonl_data`\n --> src\\analyzers\\tests\\claude_code.rs:6:9\n  |\n6 |     let jsonl_data = r#\"\n  |         ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_jsonl_data`\n\nwarning: function `parse_jsonl_file_should_add_all_stats` is never used\n --> src\\analyzers\\tests\\claude_code.rs:4:4\n  |\n4 | fn parse_jsonl_file_should_add_all_stats() {\n  |    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  |\n  = note: `#[warn(dead_code)]` on by default\n\nwarning: `splitrail` (bin \"splitrail\" test) generated 3 warnings\n    Finished `test` profile [unoptimized + debuginfo] target(s) in 3.01s\n     Running unittests src\\main.rs (target\\debug\\deps\\splitrail-5f8e4935e527e8af.exe)\nerror: test failed, to rerun pass `--bin splitrail`\n\nCaused by:\n  process didn't exit successfully: `D:\\splitrail\\target\\debug\\deps\\splitrail-5f8e4935e527e8af.exe` (exit code: 0xe06d7363)\nnote: test exited abnormally; to see the full output pass --nocapture to the harness.\n\n\nrunning 3 tests\ntest analyzers::claude_code::tests::test_summary_only_conversation_filtered ... ok"}
{"parentUuid":"577444c9-94c1-4377-f45c-fb38c8dd64d7","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"502be1cb-cf86-ecce-fe62-89ddec1e7563","version":"1.0.51","message":{"id":"msg_5473ac1758dcaebf296d66","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"The repo has minimal testing infrastructure:\n\n- One test module at `src/analyzers/tests/` with `claude_code.rs` and `mod.rs`\n- One stubbed test function `parse_jsonl_file_should_add_all_stats()` that's incomplete (empty test data, unused variables)\n- Tests run but exit abnormally with error code `0xe06d7363`\n- One passing test: `test_summary_only_conversation_filtered`\n\nThe testing setup exists but is largely incomplete and has runtime issues."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":595,"cache_read_input_tokens":17344,"output_tokens":1,"service_tier":"standard"}},"requestId":"req_367a992863fcb9d6df45","type":"assistant","uuid":"b660749d-1a75-a484-8f20-8a6cefac9f02","timestamp":"2025-08-02T14:06:16.645Z"}
{"parentUuid":"b660749d-1a75-a484-8f20-8a6cefac9f02","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"ca4578a8-b6f2-a5d2-ff7a-6041d4f68ba0","version":"1.0.51","type":"user","message":{"role":"user","content":"Please write to GEMINI.md the same stuff as is in CLAUDE.md"},"uuid":"c624e1cc-4ae2-d577-0566-3605ac28526f","timestamp":"2025-08-02T14:45:44.300Z"}
{"parentUuid":"ba7c00d3-df76-0d00-c9ab-bcf2e722c373","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"ca4578a8-b6f2-a5d2-ff7a-6041d4f68ba0","version":"1.0.51","message":{"id":"msg_16dd58b82c14895c3ad7d8","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_1f20e5360768a5be2e95","name":"Write","input":{"file_path":"D:\\splitrail\\GEMINI.md","content":" GEMINI.md\n\n...file contents..."}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":27,"cache_read_input_tokens":18749,"output_tokens":5,"service_tier":"standard"}},"requestId":"req_88018733111a4c761e22","type":"assistant","uuid":"fa7c2aa0-62c7-8a8b-62f3-eebba605cd8f","timestamp":"2025-08-02T14:46:22.666Z"}
{"parentUuid":"fa7c2aa0-62c7-8a8b-62f3-eebba605cd8f","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"ca4578a8-b6f2-a5d2-ff7a-6041d4f68ba0","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_1f20e5360768a5be2e95","type":"tool_result","content":"File created successfully at: D:\\splitrail\\GEMINI.md"}]},"uuid":"023836f3-2e4f-723e-5a92-5abaa58f146d","timestamp":"2025-08-02T14:46:35.981Z","toolUseResult":{"type":"create","filePath":"D:\\splitrail\\GEMINI.md","content":" GEMINI.md\n\n...file contents...","structuredPatch":[]}}
{"parentUuid":"023836f3-2e4f-723e-5a92-5abaa58f146d","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","type":"user","message":{"role":"user","content":"Please edit claude.md.  just some small edit"},"uuid":"5a20d37b-cef9-02f9-9f2b-db82747246ea","timestamp":"2025-08-02T15:17:21.284Z"}
{"parentUuid":"5a20d37b-cef9-02f9-9f2b-db82747246ea","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","message":{"id":"msg_b9c129d40df8d0dbf79c0f","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"I'll make a small edit to the CLAUDE.md file."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":16048,"cache_read_input_tokens":0,"output_tokens":3,"service_tier":"standard"}},"requestId":"req_d282a551f3c20fe14fed","type":"assistant","uuid":"63487a96-1e6d-a786-e0ac-2ba779d83d1c","timestamp":"2025-08-02T15:17:24.248Z"}
{"parentUuid":"914ebffd-0017-998e-8d6f-82cf9027a74a","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","message":{"id":"msg_40de5e0c050eb9249f064a","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_961c8af6044dce40c795","name":"Edit","input":{"file_path":"D:\\splitrail\\CLAUDE.md","old_string":"...old string...","new_string":"...new string..."}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":2724,"cache_read_input_tokens":16048,"output_tokens":35,"service_tier":"standard"}},"requestId":"req_36d4c6d409315b313d73","type":"assistant","uuid":"5d4ed38f-d9f3-2780-46d6-175cf9d7f2ac","timestamp":"2025-08-02T15:17:29.463Z"}
{"parentUuid":"5d4ed38f-d9f3-2780-46d6-175cf9d7f2ac","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_961c8af6044dce40c795","type":"tool_result","content":"The file D:\\splitrail\\CLAUDE.md has been updated. Here's the result of running `cat -n` on a snippet of the edited file: ..."}]},"uuid":"74e61165-b628-7c54-643e-fe692204e9de","timestamp":"2025-08-02T15:17:35.146Z","toolUseResult":{"filePath":"D:\\splitrail\\CLAUDE.md","oldString":"...old string...","newString":"...new string...","originalFile":"...original file...","structuredPatch":[{"oldStart":4,"oldLines":7,"newStart":4,"newLines":7,"lines":[" "," ## Project Overview"," ","-...old line...","+...new string..."," "," ## Development Commands"," "]}],"userModified":false,"replaceAll":false}}
{"parentUuid":"74e61165-b628-7c54-643e-fe692204e9de","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","message":{"id":"msg_d3f1476a62f207305d22af","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"Done. Added \"for enhanced development insights\" to the project overview description."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":468,"cache_read_input_tokens":18772,"output_tokens":1,"service_tier":"standard"}},"requestId":"req_605e2cffca27decc0c9c","type":"assistant","uuid":"9672b065-35db-197d-881c-42aaf6b41773","timestamp":"2025-08-02T15:17:37.687Z"}
{"parentUuid":"9672b065-35db-197d-881c-42aaf6b41773","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","type":"user","message":{"role":"user","content":"will you please now make a few small edits to it all at once?"},"uuid":"0551aa7b-7425-516e-7bcf-74b738a1f3ab","timestamp":"2025-08-02T15:18:16.309Z"}
{"parentUuid":"0551aa7b-7425-516e-7bcf-74b738a1f3ab","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","message":{"id":"msg_6b30c3f8106abbabaaf864","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"tool_use","id":"toolu_beedf1f209189aad4086","name":"MultiEdit","input":{"file_path":"D:\\splitrail\\CLAUDE.md","edits":[{"old_string":"...old string...","new_string":"...new string..."},{"old_string":"...old string...","new_string":"...new string..."},{"old_string":"...old string...","new_string":"...new string..."}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":4,"cache_creation_input_tokens":40,"cache_read_input_tokens":19240,"output_tokens":601,"service_tier":"standard"}},"requestId":"req_9797f1bfee29ff07954f","type":"assistant","uuid":"c6b5c2da-7e46-65da-3844-8e435bc0e846","timestamp":"2025-08-02T15:18:25.920Z"}
{"parentUuid":"c6b5c2da-7e46-65da-3844-8e435bc0e846","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_beedf1f209189aad4086","type":"tool_result","content":"Applied 3 edits to D:\\splitrail\\CLAUDE.md:\n1. Replaced \" Building and Testing\n- `cargo check` - Check c...\" with \" Building and Testing\n- `cargo check` - Check c...\"\n2. Replaced \"**Claude Models:**\n- `claude-sonnet-4-20250514` (S...\" with \"**Claude Models:**\n- `claude-sonnet-4-20250514` (S...\"\n3. Replaced \" Terminal User Interface\n- **Daily Stats View**...\" with \" Terminal User Interface\n- **Daily Stats View**...\""}]},"uuid":"32a8ba8a-6f2f-714c-311e-a8a886fbb766","timestamp":"2025-08-02T15:18:29.792Z","toolUseResult":{"filePath":"D:\\splitrail\\CLAUDE.md","edits":[{"old_string":"...old string...","new_string":" Building and Testing\n- `cargo check` - Check code compilation without building\n- `cargo build` - Build the project in debug mode\n- `cargo build --release` - Build optimized release version\n- `cargo test` - Run all unit tests","replace_all":false},{"old_string":"...old string...","new_string":"**Claude Models:**\n- `claude-sonnet-4-20250514` (Sonnet 4): $0.003/$0.015 per 1K input/output tokens\n- `claude-opus-4-20250514` (Opus 4): $0.015/$0.075 per 1K input/output tokens\n- `claude-3-5-sonnet-20241022` (Sonnet 3.5): Legacy model support","replace_all":false},{"old_string":"...old string...","new_string":"...new string...","replace_all":false}],"originalFileContents":"...original file...","structuredPatch":[{"oldStart":12,"oldLines":6,"newStart":12,"newLines":7,"lines":[" - `cargo check` - Check code compilation without building"," - `cargo build` - Build the project in debug mode"," - `cargo build --release` - Build optimized release version","+- `cargo test` - Run all unit tests"," - `cargo run` - Run with default behavior (show stats + optional auto-upload)"," - `cargo run -- upload` - Force upload stats to leaderboard"," - `cargo run -- config <subcommand>` - Manage configuration"]},{"oldStart":74,"oldLines":6,"newStart":75,"newLines":7,"lines":[" **Claude Models:**"," - `claude-sonnet-4-20250514` (Sonnet 4): $0.003/$0.015 per 1K input/output tokens"," - `claude-opus-4-20250514` (Opus 4): $0.015/$0.075 per 1K input/output tokens","+- `claude-3-5-sonnet-20241022` (Sonnet 3.5): Legacy model support"," - Cache pricing for both models (creation + read costs)"," "," **Gemini Models:**"]},{"oldStart":148,"oldLines":6,"newStart":150,"newLines":7,"lines":[" - **Daily Stats View**: Comprehensive daily breakdown with costs, tokens, and operations"," - **Model Usage**: Model-specific statistics and abbreviations across all supported tools"," - **File Operations**: Detailed file operation analytics by category","+- **Real-time Updates**: Live refresh of statistics during analysis"," - **Navigation**: Keyboard controls for scrolling and interaction"," "," ### Leaderboard Integration"]}],"userModified":false}}
{"parentUuid":"32a8ba8a-6f2f-714c-311e-a8a886fbb766","isSidechain":false,"userType":"external","cwd":"D:\\splitrail","sessionId":"0f8ece33-ff50-95d6-124b-1cfed68ceaee","version":"1.0.51","message":{"id":"msg_5a61d140894d1a90c4f53e","type":"message","role":"assistant","model":"claude-sonnet-4-20250514","content":[{"type":"text","text":"Made three small edits: added `cargo test` command, added legacy Sonnet 3.5 model support, and added real-time updates feature to the TUI section."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":7,"cache_creation_input_tokens":718,"cache_read_input_tokens":19280,"output_tokens":42,"service_tier":"standard"}},"requestId":"req_40dc084beaae3ffc2744","type":"assistant","uuid":"47ecbf29-6ecb-2e56-471d-d8c47e843fe5","timestamp":"2025-08-02T15:18:33.546Z"}"#.to_string()
});

#[test]
fn parse_jsonl_file_should_pass() {
    use std::io::{BufReader, Cursor};
    use std::path::Path;

    use crate::analyzers::claude_code::parse_jsonl_file;

    let cursor: Cursor<String> = Cursor::new(JSONL_DATA.clone());
    let mut buf_reader = BufReader::new(cursor);

    let messages = parse_jsonl_file(&Path::new("test.jsonl"), &mut buf_reader);

    assert_eq!(messages.len(), 35);

    // Token usage.
    assert_eq!(messages[1].stats.input_tokens, 4);
    assert_eq!(messages[1].stats.cache_creation_tokens, 16027);
    assert_eq!(messages[1].stats.cache_read_tokens, 0);
    assert_eq!(messages[1].stats.output_tokens, 7);

    // Terminal commands.
    assert_eq!(messages[20].stats.terminal_commands, 1);

    // File operations.
    assert_eq!(messages[14].stats.files_read, 1);
    assert_eq!(messages[24].stats.files_added, 1);
    assert_eq!(messages[28].stats.files_edited, 1);
    assert_eq!(messages[32].stats.files_edited, 1);
}

